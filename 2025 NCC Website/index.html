<!DOCTYPE html>
<html>

<head>
    <title>North Canterbury Chess</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <script type="text/javascript" src="js/NCCscript.js"></script>
</head>

<body>

    <header>
        <div class="header-brand">
            <img src="images/logo.png" alt="North Canterbury Chess Logo" class="header-logo">
            <h1><a href="http://northcanterburychess.nz/">North Canterbury Chess</a></h1>
        </div>
        <h4>Supporting chess in North Canterbury, New Zealand</h4>
        <nav>
            <ul>
                <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="about.html"><i class="fas fa-info-circle"></i> About Us</a></li>
                <li><a href="results.html"><i class="fas fa-trophy"></i> Results</a></li>
                <li><a href="ratings.html"><i class="fas fa-chart-line"></i> Ratings</a></li>
                <li><a href="about.html#download"><i class="fas fa-download"></i> Downloads</a></li>
                <li><a href="about.html#contact"><i class="fas fa-envelope"></i> Contact</a></li>
            </ul>
        </nav>
    </header>

    <main class="main-content">
        <div class="content-area">
            <h1>Quote of the day</h1>
            <script type="text/javascript">Show_Quote()</script>
            <h1>Events</h1>
            <p>NCC normally meets on the first and third Tuesday of each month.</p>

            <div class="calendar-container">
                <div class="calendar-header">
                    <h2>April 2025</h2>
                    <div class="calendar-controls">
                        <button class="calendar-control-button" id="prev-month">❮</button>
                        <button class="calendar-control-button" id="next-month">❯</button>
                    </div>
                </div>
                <table class="calendar"></table>
            </div>
            <p>Click on the dates to see the events.</p>

            <!-- Event Popup -->
            <div class="event-popup-backdrop"></div>
            <div class="event-popup">
                <button class="event-popup-close">&times;</button>
                <div class="event-popup-date"></div>
                <div class="event-popup-content"></div>
            </div>

            <h1>Posts</h1>

            <article id="article1" class="article">
                <h2>End of Year Blitz 2024</h2>
                <p class="post-date">Posted on: 31 Dec 2024</p>
                <h4>Winner: Akash Patel (9.0/10)</h4>
                <p>Our year ending tournament was the annual End-Of-Year-Blitz. The competition was played as a round
                    robin over 10 rounds.
                    Games were played at 5 minutes per player per game.</p>
                <p>Congratulations to new Club Champion Akash Patel for winning the competition.
                    Akash fought off a strong challenge from Bob van den Bergh who took second place.</p>
                <p>Both Steve and Simon Barber have converted their provisional Blitz ratings into full Blitz ratings.
                </p>
                <p>Full Results &raquo; <a href="results.html#EYBlitz">2024 End of Year Blitz&#8230;</a></p>
            </article>

            <article id="article2" class="article">
                <h2>Club Ladder 2024</h2>
                <p class="post-date">Posted on: 8 Dec 2024</p>
                <h4>Ladies &amp; Gentlemen we have a new Club Champion: Akash Patel!</h4>
                <p>Akash demolished former Champion Scott Stringer in the final played last Tuesday.
                    The new Champion showed absolutely no mercy pouncing on any inaccuracies and quickly turned the game
                    into a winning position.
                    Scott was forced to resign on move 16.</p>
                <p>2023 Champion Tony Kesseller did not defend his title this year.</p>
                <p>Akash's victory in the final means he has now won the Club Ladder for 2024 and is the new Club
                    Champion.</p>
                <img src="images/akash.jpg" alt="Akash Patel - Club Champion 2024" class="chess-image">
                <p class="caption">Akash Patel, winner of both the 2024 Club Championship and End of Year Blitz</p>

                <p>Full Results &raquo; <a href="results.html#NCCChamps">2024 Club Ladder…</a></p>
            </article>

            <article id="article3" class="article">
                <h2>King's Gambit 2024</h2>
                <p class="post-date">Posted on: 26 Nov 2024</p>
                <h4>Winner: Bob van den Bergh (5/5)</h4>
                <p>
                <p>This is an extended competition, played over two consecutive nights.</p>
                <p>Bob van den Bergh was the clear winner on a perfect 5/5. He and Akash fought out a
                    difficult and instructive pawn endgame to conclude the final game.</p>
                <p>Full Results &raquo; <a href="results.html#KingGambit">2024 King's Gambit…</a></p>
            </article>

            <article id="article4" class="article">
                <h2>Midwinter Blitz 2024</h2>
                <p class="post-date">Posted on: 6 Jul 2024</p>
                <h4>Winners: Akash Patel &amp; Bob van den Bergh (5.5/7)</h4>
                <p>10 players competed in this year's Midwinter Blitz competition.
                    Seven rounds were played with games timed at five minutes-per-player-per-game.</p>
                <p>Five unrated players earned their first NCC Blitz rating and Dean gained his full Blitz rating.</p>
                <p>Congratulations to Akash and Bob who shared first place.</p>
                <p>Full Results &raquo; <a href="results.html#MWBlitz">2024 Midwinter Blitz...</a></p>
            </article>
        </div>
        <div class="right-sidebar">
            <ul>
                <li>
                    <h3>Recent Posts</h3>
                    <ul>
                        <li><a href="#article1">2024 End of Year Blitz - results</a></li>
                        <li><a href="#article2">2024 Club Ladder - results</a></li>
                        <li><a href="#article3">2024 King's Gambit - results</a></li>
                        <li><a href="#article4">2024 Midwinter Blitz - results</a></li>
                    </ul>
                </li>
                <li>
                    <h3>Chess News &amp; Articles</h3>
                    <div id="feedContent"></div>
                </li>
            </ul>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 North Canterbury Chess. All rights reserved.</p>
    </footer>

    <script>
        const calendarContainer = document.querySelector('.calendar-container');
        const monthHeader = calendarContainer.querySelector('.calendar-header h2');
        const calendarTable = calendarContainer.querySelector('.calendar');
        const prevMonthButton = calendarContainer.querySelector('#prev-month');
        const nextMonthButton = calendarContainer.querySelector('#next-month');

        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        const monthNames = ["January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"];

        // Array of events
        const events = [
            { date: '2025-04-01', title: 'Free play' },
            { date: '2025-04-15', title: 'AGM / Free play' },
            { date: '2025-05-06', title: 'Free play' },
            { date: '2025-05-20', title: 'Club Ladder #3 (of 6)' },
            { date: '2025-06-03', title: 'Free play' },
            { date: '2025-06-17', title: 'Club Ladder #4 (of 6)' },
            { date: '2025-07-01', title: 'Midwinter Blitz' },
            { date: '2025-07-15', title: 'Club Ladder #5 (of 6)' },
            { date: '2025-08-05', title: 'Free play' },
            { date: '2025-08-19', title: 'Club Ladder #6 (of 6)' },
            { date: '2025-09-02', title: 'Free play (Club Ladder semi-finals)' },
            { date: '2025-09-16', title: 'Free play (Club Ladder semi-finals)' },
            { date: '2025-10-07', title: 'Free play (Club Ladder Final)' },
            { date: '2025-10-21', title: 'Free play (Club Ladder Final)' },
            { date: '2025-11-04', title: 'Kings Gambit #1 (of 2)' },
            { date: '2025-11-18', title: 'Kings Gambit #2 (of 2)' },
            { date: '2025-12-02', title: 'Free play' },
            { date: '2025-12-16', title: 'End of Year Blitz' },
            { date: '2026-01-06', title: 'NO MEETING' },
            { date: '2026-01-20', title: 'Free play' },
            { date: '2026-02-03', title: 'Free play' }
        ];

        // Centralize popup handling
        const popup = {
            show: (dateStr, events) => {
                const popup = document.querySelector('.event-popup');
                const backdrop = document.querySelector('.event-popup-backdrop');
                const dateEl = popup.querySelector('.event-popup-date');
                const contentEl = popup.querySelector('.event-popup-content');
                
                const formattedDate = new Date(dateStr).toLocaleDateString('en-NZ', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                dateEl.textContent = formattedDate;
                contentEl.innerHTML = events.map(e => `<p>${e.title}</p>`).join('');
                
                popup.style.display = 'block';
                backdrop.style.display = 'block';
            },
            hide: () => {
                document.querySelector('.event-popup').style.display = 'none';
                document.querySelector('.event-popup-backdrop').style.display = 'none';
            }
        };

        // Add event handlers only once
        document.querySelector('.event-popup-close')?.addEventListener('click', popup.hide);
        document.querySelector('.event-popup-backdrop')?.addEventListener('click', popup.hide);

        function createCalendar(month, year, events) {
            calendarTable.innerHTML = `
                <thead>
                    <tr>
                        <th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            `;
            monthHeader.textContent = `${monthNames[month]} ${year}`;

            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            const todayDate = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;


            let dayCounter = 1;
            let tableBody = calendarTable.querySelector('tbody');

            for (let i = 0; i < 6; i++) { // Max 6 rows
                let row = tableBody.insertRow();
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < firstDayOfMonth) {
                        row.insertCell().textContent = '';
                    } else if (dayCounter <= daysInMonth) {
                        const cell = row.insertCell();
                        cell.textContent = dayCounter;

                        // Add weekend class
                        if (j === 0 || j === 6) {
                            cell.classList.add('weekend');
                        }

                        // Add events for the current day
                        const eventDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(dayCounter).padStart(2, '0')}`;
                        const dayEvents = events.filter(event => event.date === eventDate);
                        if (dayEvents.length > 0) {
                            cell.classList.add('event-day');
                            cell.addEventListener('click', () => popup.show(eventDate, dayEvents));
                        }

                        if (eventDate === todayDate) {
                            cell.classList.add('today');
                            cell.title = "Today";
                        }

                        dayCounter++;
                    } else {
                        row.insertCell().textContent = '';
                    }
                }
                if (dayCounter > daysInMonth) break;
            }
        }

        prevMonthButton.addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            createCalendar(currentMonth, currentYear, events);
        });

        nextMonthButton.addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            createCalendar(currentMonth, currentYear, events);
        });

        createCalendar(currentMonth, currentYear, events); // Initial render

        loadRSSFeed(); // Add this line to load the feed when page loads
    </script>
</body>

</html>